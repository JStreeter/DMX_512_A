/// @file    Timers.c
/// @author  Jonathan Streeeter
/// @date    Septmber 28, 2015
/// @brief   Timers and fun stuff
/// @details 
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
	// INCLUDES
////////////////////////////////////////////////////////////////////////////////
#include <main.h>
#include "TM4C123GH6PM.h"                    // Device header
#include "Serial.h"
#include "inc/hw_timer.h"
#include "driverlib/timer.h"
#include "driverlib/interrupt.h"
#include "inc/hw_types.h"
#include "inc/hw_uart.h"
#include "driverlib/uart.h"
#include "inc/hw_gpio.h"
#include "driverlib/udma.h"
#include <stdio.h>
////////////////////////////////////////////////////////////////////////////////
	// EXTERNALS
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
	// GLOBALS
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
	//  CONSTANTS
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
	// FUNCTIONS
////////////////////////////////////////////////////////////////////////////////
void TIMER0A_Handler()
{	
	TimerIntClear(TIMER0_BASE,TIMER_TIMA_TIMEOUT);//TIMER TIME OUT

	if(LastPingPongSemaphore != PingPongSemaphore)
	{
		if(PingPongSemaphore == 0)
		{
		uDMAChannelTransferSet( UDMA_CHANNEL_UART0TX | UDMA_PRI_SELECT, UDMA_MODE_BASIC,
									PingDMX,
									(void *)(UART0_BASE + UART_O_DR),
									513);
		}
		else
		{
		uDMAChannelTransferSet( UDMA_CHANNEL_UART0TX | UDMA_PRI_SELECT, UDMA_MODE_BASIC,
									PongDMX,
									(void *)(UART0_BASE + UART_O_DR),
									513);
		}
	}
	
	LastPingPongSemaphore = PingPongSemaphore;
	uDMAChannelEnable(UDMA_CHANNEL_UART0TX);
	UARTDMAEnable(UART0_BASE, UART_DMA_TX);
	uDMAChannelRequest(UDMA_CHANNEL_UART0TX);
	

	
	Semaphore = 1;
}
